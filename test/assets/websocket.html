<script>
  function createClient() {
    const client = new WebSocket(`ws://${location.host}`);
    client.addEventListener('open', () => console.log('opened'));
    client.addEventListener('close', () => console.log('closed'));
    return client;
  }

  function createAndDestroyClientAfterDelay(delay = 100) {
    const client = createClient();
    setTimeout(() => client.close(), delay);
  }

  setTimeout(createAndDestroyClientAfterDelay, 0);
  setTimeout(createAndDestroyClientAfterDelay, 200);
  setTimeout(createAndDestroyClientAfterDelay, 400);
  setTimeout(createAndDestroyClientAfterDelay, 600);
</script>

<script src="delayed-request-1.js?delay=3000"></script>
<script src="delayed-request-2.js?delay=3000"></script>
<script src="delayed-request-3.js?delay=3000"></script>
