<script>
  function createClient() {
    const client = new WebSocket(`ws://${location.host}`);
    client.addEventListener('open', () => console.log('opened'));
    client.addEventListener('close', () => console.log('closed'));
    return client;
  }

  function createAndDestroyClientAfterDelay(delay = 50) {
    const client = createClient();
    setTimeout(() => client.close(), delay);
  }

  fetch('fetch-request.js');
  setTimeout(createAndDestroyClientAfterDelay, 0);
  setTimeout(createAndDestroyClientAfterDelay, 100);
  setTimeout(createAndDestroyClientAfterDelay, 200);
  setTimeout(createAndDestroyClientAfterDelay, 300);
</script>
